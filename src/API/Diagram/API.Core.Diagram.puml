@startuml
scale 1
' skinparam classAttributeIconSize 0

namespace API.Mail #DDDDDD {
    IMailAddress "2" *-- IMail
    IMessage "1" *-- IMail

    IContent <|-- IMessage
    IHeader <|-- IMessage
    IAddressee <|-- IMailAddress
    IAddress <|-- IMailAddress

    interface IAddress
    {
        + String Address 
    }
    interface IAddressee
    {
        + String Addressee
    } 

    interface IMailAddress
    {
    }

    interface IHeader
    {
        + String Header 
    }
    interface IContent
    {
        + JSON Content
    }
    interface IMessage
    {
    }
    interface IMail
    {
        + IMailAddress reciever
        + IMailAddress sender
        + IMessage message
    }
}

namespace API.Send #DDDDDD {
    interface IMailSender
    {
        + MailPicker mailPicker
        + IMail createMessage(String command)
        + void send(IMail)
    }
    class MailPicker << (S,#FF7700) Singleton >>
    {
        - List<IPostSender> sendes
        + void refreshSenders()

        + void send(IMail)
    }
    interface IPostSender
    {
        + void init()
        + void send(IMail)
    }
    class FMailSender << (F,#FF7700) Factory >>
    {
        + List<IMailSenderClass> scan()
        + List<IMailSender> createIntances(List<IMailSenderClass>)
    }
    class FPostSender << (F,#FF7700) Factory >>
    {
        + List<IPostSenderClass> scan()
        + List<IPostSenderClass> testConnection(List<IPostSenderClass>)
        + List<IPostSender> createIntances(List<IPostSenderClass>)
    }
    FMailSender --o MailPicker
    FMailSender -> IMailSender
    IMailSender ..> API.Mail.IMail
    IMailSender "many" --* MailPicker :send
    MailPicker --> API.Mail.IMail
    MailPicker --o "1" FPostSender :refreshSenders
    MailPicker --o "many" IPostSender
    API.Mail.IMail <-- IPostSender
    IPostSender <- FPostSender
}


namespace API.Receive #DDDDDD {
    interface IMailReceiver
    {
        + void handleMessage(IMail)
        + void receive(IMail)
    }
    class MailSorter << (S,#FF7700) Singleton >>
    {
        - List<IPostReceiver> recieves
        - List<IMailReceiver> recipients
        + void refreshReceivers()
 
        + void registerRecipient(IMailReceiver)
        + void deleteRecipient(IMailReceiver)

       + void receive(IMail)
    }
    interface IPostReceiver
    {
        + IMailReceiver MailReceiver
        + void init(MailSorter)
        + void received(IMail)
    }
    class FMailReceiver << (F,#FF7700) Factory >>
    {
        + List<IMailReceiverClass> scan()
        + List<IMailReceiver> createIntances(List<IMailReceiverClass>)
    }
    class FPostReceiver << (F,#FF7700) Factory >>
    {
        + List<IPostReceiverClass> scan()
        + List<IPostReceiverClass> testConnection(List<IPostReceiverClass>)
        + List<IPostReceiver> createIntances(List<IPostReceiverClass>)
    }
    FMailReceiver --> MailSorter : registerRecipient
    IMailReceiver <- FMailReceiver
    IMailReceiver --> API.Mail.IMail
    IMailReceiver "many" o-- MailSorter
    MailSorter --> API.Mail.IMail
    MailSorter --o "1" FPostReceiver : refreshReceivers
    MailSorter --o "many" IPostReceiver
    API.Mail.IMail <-- IPostReceiver
    IPostReceiver <- FPostReceiver
}

namespace API.Common #DDDDDD {
    abstract class ClassFounderByInterface
    {
        List<Type> findClassesImplementsInterface(Type interface)
    }
    interface ITestConnection
    {
        bool TestConnection();
    }
    interface ICreateInstance
    {
        object CreateInstance();
    }
    interface IMailHandler
    {
    }
    IMailHandler <|-- IMailReceiver
    IMailHandler <|-- IMailSender
    interface IPostHandler
    {
    }
    IPostReceiver --|> IPostHandler
    IPostSender  --|> IPostHandler

}







@enduml